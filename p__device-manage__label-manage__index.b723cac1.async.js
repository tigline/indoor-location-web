"use strict";(self.webpackChunkheyanai_navigation=self.webpackChunkheyanai_navigation||[]).push([[43],{51042:function(N,I,e){var p=e(1413),v=e(67294),j=e(42110),s=e(98615),y=function(_,c){return v.createElement(s.Z,(0,p.Z)((0,p.Z)({},_),{},{ref:c,icon:j.Z}))};y.displayName="PlusOutlined",I.Z=v.forwardRef(y)},64317:function(N,I,e){var p=e(1413),v=e(91),j=e(22270),s=e(67294),y=e(66758),r=e(86682),_=e(85893),c=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],m=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],f=s.forwardRef(function(u,O){var R=u.fieldProps,W=u.children,x=u.params,Z=u.proFieldProps,B=u.mode,A=u.valueEnum,d=u.request,G=u.showSearch,U=u.options,z=(0,v.Z)(u,c),w=(0,s.useContext)(y.Z);return(0,_.jsx)(r.Z,(0,p.Z)((0,p.Z)({valueEnum:(0,j.h)(A),request:d,params:x,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,p.Z)({options:U,mode:B,showSearch:G,getPopupContainer:w.getPopupContainer},R),ref:O,proFieldProps:Z},z),{},{children:W}))}),P=s.forwardRef(function(u,O){var R=u.fieldProps,W=u.children,x=u.params,Z=u.proFieldProps,B=u.mode,A=u.valueEnum,d=u.request,G=u.options,U=(0,v.Z)(u,m),z=(0,p.Z)({options:G,mode:B||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},R),w=(0,s.useContext)(y.Z);return(0,_.jsx)(r.Z,(0,p.Z)((0,p.Z)({valueEnum:(0,j.h)(A),request:d,params:x,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,p.Z)({getPopupContainer:w.getPopupContainer},z),ref:O,proFieldProps:Z},U),{},{children:W}))}),S=f,h=P,C=S;C.SearchSelect=h,C.displayName="ProFormComponent",I.Z=C},5966:function(N,I,e){var p=e(1413),v=e(91),j=e(67294),s=e(86682),y=e(85893),r=["fieldProps","proFieldProps"],_=["fieldProps","proFieldProps"],c="text",m=function(h){var C=h.fieldProps,u=h.proFieldProps,O=(0,v.Z)(h,r);return(0,y.jsx)(s.Z,(0,p.Z)({valueType:c,fieldProps:C,filedConfig:{valueType:c},proFieldProps:u},O))},f=function(h){var C=h.fieldProps,u=h.proFieldProps,O=(0,v.Z)(h,_);return(0,y.jsx)(s.Z,(0,p.Z)({valueType:"password",fieldProps:C,proFieldProps:u,filedConfig:{valueType:c}},O))},P=m;P.Password=f,P.displayName="ProFormComponent",I.Z=P},89512:function(N,I,e){e.d(I,{v:function(){return y}});var p=e(35312),v=e(86738),j=e(71577),s=e(85893);function y(r){var _,c,m,f,P=(0,p.useIntl)();return(0,s.jsx)(v.Z,{title:(_=r.title)!==null&&_!==void 0?_:P.formatMessage({id:"app.remove.confirm.title",defaultMessage:"\u4F60\u786E\u5B9A\u8981\u5220\u9664\u6B64\u9879\u5417?"}),description:(c=r.title)!==null&&c!==void 0?c:P.formatMessage({id:"app.remove.confirm.description",defaultMessage:"\u5220\u9664\u6B64\u9879"}),okButtonProps:{loading:r.loading},getPopupContainer:r.getPopupContainer,onConfirm:function(){var h;return r==null||(h=r.onClick)===null||h===void 0?void 0:h.call(r)},children:!r.children&&(0,s.jsx)(j.ZP,{type:(m=r.type)!==null&&m!==void 0?m:"link",size:(f=r.size)!==null&&f!==void 0?f:"small",disabled:r.disabled,children:(0,s.jsx)(p.FormattedMessage,{id:"app.remove",defaultMessage:"\u5220\u9664"})})})}},12372:function(N,I,e){e.r(I),e.d(I,{default:function(){return Y}});var p=e(97857),v=e.n(p),j=e(13769),s=e.n(j),y=e(89512),r=e(84140),_=e(69851),c=e(90930),m=e(9455),f=e(35312),P=e(71577),S=e(80129),h=e.n(S),C=e(67294),u=e(5574),O=e.n(u),R=e(51042),W=e(37476),x=e(5966),Z=e(64317),B=e(12029),A=e(54689),d=e(85893);function G(M){var V=B.Z.useForm(),D=O()(V,1),g=D[0],o=(0,f.useIntl)();return(0,d.jsxs)(W.Y,{title:(0,d.jsx)(f.FormattedMessage,{id:"pages.device-manage.label.device.add",defaultMessage:"\u6DFB\u52A0\u6807\u7B7E"}),layout:"horizontal",form:g,labelCol:{xs:6},wrapperCol:{xs:16},width:550,onFinish:function(b){return(0,r.x2)(v()(v()({},b),{},{name:b.name,deviceId:b.deviceId})).then(function($){var E;return(E=M.refresh)===null||E===void 0||E.call(M),$.code===_.OK&&A.Z.success({message:o.formatMessage({id:"app.add.success",defaultMessage:"\u65B0\u5EFA\u6210\u529F"})}),$.code===_.OK})},modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},trigger:(0,d.jsxs)(P.ZP,{type:"primary",children:[(0,d.jsx)(R.Z,{}),o.formatMessage({id:"app.action.add",defaultMessage:"\u6DFB\u52A0"})]}),children:[(0,d.jsx)(x.Z,{width:"lg",name:"deviceId",label:o.formatMessage({id:"pages.device-manage.label.device.deviceId",defaultMessage:"\u8BBE\u5907ID"}),rules:[{required:!0,message:o.formatMessage({id:"pages.device-manage.label.device.deviceId.required.failure",defaultMessage:"\u8BBE\u5907ID\u5FC5\u586B"})},{pattern:/^[0-9a-fA-F,]+$/,message:o.formatMessage({id:"pages.device-manage.label.device.mac.hex.failure",defaultMessage:"\u7269\u7406\u5730\u5740\u5FC5\u586B"})}]}),(0,d.jsx)(x.Z,{width:"lg",name:"name",label:o.formatMessage({id:"pages.device-manage.base-station.device.name",defaultMessage:"\u540D\u79F0"})}),(0,d.jsx)(Z.Z,{name:"type",label:o.formatMessage({id:"pages.device-manage.label.type",defaultMessage:"\u7C7B\u578B"}),initialValue:"Equipment",valueEnum:{Equipment:o.formatMessage({id:"pages.device-manage.label.type.equipment",defaultMessage:"\u8BBE\u5907"}),Personnel:o.formatMessage({id:"pages.device-manage.label.type.personnel",defaultMessage:"\u4EBA\u5458"}),Vehicle:o.formatMessage({id:"pages.device-manage.label.type.vehicle",defaultMessage:"\u5DE5\u5177"}),Stuff:o.formatMessage({id:"pages.device-manage.label.type.stuff",defaultMessage:"\u6750\u6599"})},rules:[{required:!0,message:o.formatMessage({id:"pages.device-manage.label.type.required.failure",defaultMessage:"\u7C7B\u578B\u5FC5\u586B"})}]})]})}var U=e(491);function z(M){var V=B.Z.useForm(),D=O()(V,1),g=D[0],o=(0,f.useIntl)(),K=(0,f.useRequest)(U.as,{manual:!0,formatResult:function(n){var t,i;return(t=n.data)===null||t===void 0||(i=t.items)===null||i===void 0?void 0:i.map(function(l){return{label:l.name,value:l.fenceId}})}}),b=K.run,$=K.data;return C.useEffect(function(){b({current:"1",size:"100"})},[]),(0,d.jsxs)(W.Y,{title:(0,d.jsx)(f.FormattedMessage,{id:"pages.device-manage.label.device.edit",defaultMessage:"\u7F16\u8F91"}),layout:"horizontal",form:g,labelCol:{xs:6},wrapperCol:{xs:16},width:550,onFinish:function(n){var t=n.name,i=n.type,l=n.fenceIds;return(0,r.Ig)({deviceId:M.record.deviceId},{name:t,type:i,fenceIds:l}).then(function(a){var T;return a.code===_.OK&&A.Z.success({message:o.formatMessage({id:"app.edit.success",defaultMessage:"\u66F4\u65B0\u6210\u529F"})}),(T=M.refresh)===null||T===void 0||T.call(M),a.code===_.OK})},modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},trigger:(0,d.jsx)(P.ZP,{type:"link",size:"small",children:o.formatMessage({id:"app.edit",defaultMessage:"\u66F4\u65B0\u6807\u7B7E"})}),children:[(0,d.jsx)(x.Z,{width:"lg",name:"deviceId",fieldProps:{disabled:!0},initialValue:M.record.deviceId,label:o.formatMessage({id:"pages.device-manage.base-station.device.code",defaultMessage:"\u7F16\u53F7"}),rules:[{required:!1}]}),(0,d.jsx)(x.Z,{width:"lg",name:"name",initialValue:M.record.name,label:o.formatMessage({id:"pages.device-manage.base-station.device.name",defaultMessage:"\u540D\u79F0"})}),(0,d.jsx)(Z.Z,{name:"type",label:o.formatMessage({id:"pages.device-manage.label.type",defaultMessage:"\u7C7B\u578B"}),initialValue:M.record.type,valueEnum:{Equipment:o.formatMessage({id:"pages.device-manage.label.type.equipment",defaultMessage:"\u8BBE\u5907"}),Personnel:o.formatMessage({id:"pages.device-manage.label.type.personnel",defaultMessage:"\u4EBA\u5458"}),Vehicle:o.formatMessage({id:"pages.device-manage.label.type.vehicle",defaultMessage:"\u5DE5\u5177"}),Stuff:o.formatMessage({id:"pages.device-manage.label.type.stuff",defaultMessage:"\u6750\u6599"})},rules:[{required:!0,message:o.formatMessage({id:"pages.device-manage.label.type.required.failure",defaultMessage:"\u7C7B\u578B\u5FC5\u586B"})}]}),(0,d.jsx)(Z.Z,{name:"fenceIds",initialValue:M.record.fenceIds,label:o.formatMessage({id:"pages.device-manage.label.device.fence",defaultMessage:"\u7ED1\u5B9A\u56F4\u680F"}),options:$})]})}var w=["current","pageSize"];function Y(){var M=C.useRef(),V=(0,f.useModel)("messageSocket"),D=V.beacons,g=(0,f.useIntl)(),o=(0,f.useRequest)(r.Zc,{manual:!0,fetchKey:function(n){return n.deviceId}}),K=o.run,b=o.fetches,$=[{title:g.formatMessage({id:"pages.device-manage.base-station.device.code",defaultMessage:"\u7F16\u53F7"}),dataIndex:"deviceId",copyable:!0,ellipsis:!0},{title:g.formatMessage({id:"pages.device-manage.base-station.device.name",defaultMessage:"\u540D\u79F0"}),dataIndex:"name",copyable:!0,ellipsis:!0},{disable:!0,title:g.formatMessage({id:"pages.device-manage.base-station.device.type",defaultMessage:"\u7C7B\u578B"}),dataIndex:"type",search:!1,valueType:"select",renderFormItem:function(n,t){var i=t.defaultRender;return i(n)},valueEnum:{Equipment:g.formatMessage({id:"pages.device-manage.label.device.equipment",defaultMessage:"\u88C5\u5907"}),Personnel:g.formatMessage({id:"pages.device-manage.label.device.personnel",defaultMessage:"\u4EBA\u5458"}),Vehicle:g.formatMessage({id:"pages.device-manage.label.device.vehicle",defaultMessage:"\u8F66\u8F86"}),Stuff:g.formatMessage({id:"pages.device-manage.label.device.stuff",defaultMessage:"\u6750\u6599"})}},{title:g.formatMessage({id:"pages.device-manage.base-station.device.time",defaultMessage:"\u52A0\u5165\u65F6\u95F4"}),key:"updateTime",dataIndex:"updateTime",valueType:"dateTime",sorter:!0,hideInSearch:!0},{disable:!0,title:g.formatMessage({id:"pages.device-manage.base-station.device.state",defaultMessage:"\u72B6\u6001"}),dataIndex:"status",filters:!0,onFilter:!0,ellipsis:!0,valueType:"select",search:!1,valueEnum:{Bound:g.formatMessage({id:"pages.device-manage.label.device.bound",defaultMessage:"\u7ED1\u5B9A"}),Unbound:g.formatMessage({id:"pages.device-manage.label.device.unbound",defaultMessage:"\u672A\u7ED1\u5B9A"})}},{title:g.formatMessage({id:"app.action",defaultMessage:"\u64CD\u4F5C"}),valueType:"option",key:"option",render:function(n,t,i,l){var a;return(0,d.jsxs)(P.ZP.Group,{children:[(0,d.jsx)(z,{record:t,refresh:l==null?void 0:l.reload}),(D==null?void 0:D[t.deviceId])&&(0,d.jsx)(P.ZP,{hidden:!t.online,type:"link",size:"small",children:(0,d.jsx)(f.Link,{to:"/position-manage/real-time-location".concat(h().stringify({deviceId:t.deviceId,mapId:t.mapId},{addQueryPrefix:!0})),children:g.formatMessage({id:"app.view",defaultMessage:"\u67E5\u770B\u5730\u56FE"})})}),(0,d.jsx)(y.v,{disabled:!t.deviceId,onClick:function(){return K({deviceId:t.deviceId}).then(function(){return l==null?void 0:l.reload()})},loading:b==null||(a=b[t.deviceId])===null||a===void 0?void 0:a.loading})]})}}];return(0,d.jsx)(c._z,{childrenContentStyle:{padding:20},children:(0,d.jsx)(m.Z,{options:{setting:!1},actionRef:M,columns:$,request:function(n){var t=n.current,i=n.pageSize,l=s()(n,w);return(0,r.$h)(v()({current:""+t,size:""+i},l)).then(function(a){return(0,_.LF)(a)})},toolBarRender:function(n){return[(0,d.jsx)(G,{refresh:n==null?void 0:n.reload},"add")]}})})}},84140:function(N,I,e){e.d(I,{$h:function(){return C},Ig:function(){return W},TB:function(){return $},Um:function(){return g},WN:function(){return Y},Zc:function(){return Z},_s:function(){return G},aL:function(){return K},bD:function(){return z},s_:function(){return V},uz:function(){return A},x2:function(){return O}});var p=e(13769),v=e.n(p),j=e(15009),s=e.n(j),y=e(97857),r=e.n(y),_=e(99289),c=e.n(_),m=e(35312),f=["deviceId"],P=["deviceId"],S=["gateway"],h=["gateway"];function C(n,t){return u.apply(this,arguments)}function u(){return u=c()(s()().mark(function n(t,i){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,m.request)("/api/v1/beacon",r()({method:"GET",params:r()({current:"1",size:"10"},t)},i||{})));case 1:case"end":return a.stop()}},n)})),u.apply(this,arguments)}function O(n,t){return R.apply(this,arguments)}function R(){return R=c()(s()().mark(function n(t,i){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,m.request)("/api/v1/beacon",r()({method:"POST",headers:{"Content-Type":"application/json"},data:t},i||{})));case 1:case"end":return a.stop()}},n)})),R.apply(this,arguments)}function W(n,t,i){return x.apply(this,arguments)}function x(){return x=c()(s()().mark(function n(t,i,l){var a,T;return s()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return a=t.deviceId,T=v()(t,f),L.abrupt("return",(0,m.request)("/api/v1/beacon/".concat(a),r()({method:"PUT",headers:{"Content-Type":"application/json"},params:r()({},T),data:i},l||{})));case 2:case"end":return L.stop()}},n)})),x.apply(this,arguments)}function Z(n,t){return B.apply(this,arguments)}function B(){return B=c()(s()().mark(function n(t,i){var l,a;return s()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return l=t.deviceId,a=v()(t,P),F.abrupt("return",(0,m.request)("/api/v1/beacon/".concat(l),r()({method:"DELETE",params:r()({},a)},i||{})));case 2:case"end":return F.stop()}},n)})),B.apply(this,arguments)}function A(n,t){return d.apply(this,arguments)}function d(){return d=c()(s()().mark(function n(t,i){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,m.request)("/api/v1/gateway",r()({method:"GET",params:r()({current:"1",size:"10"},t)},i||{})));case 1:case"end":return a.stop()}},n)})),d.apply(this,arguments)}function G(n,t){return U.apply(this,arguments)}function U(){return U=c()(s()().mark(function n(t,i){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,m.request)("/api/v1/gateway",r()({method:"POST",headers:{"Content-Type":"application/json"},data:t},i||{})));case 1:case"end":return a.stop()}},n)})),U.apply(this,arguments)}function z(n,t){return w.apply(this,arguments)}function w(){return w=c()(s()().mark(function n(t,i){var l,a;return s()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return l=t.gateway,a=v()(t,S),F.abrupt("return",(0,m.request)("/api/v1/gateway/".concat(l),r()({method:"DELETE",params:r()({},a)},i||{})));case 2:case"end":return F.stop()}},n)})),w.apply(this,arguments)}function Y(n,t,i){return M.apply(this,arguments)}function M(){return M=c()(s()().mark(function n(t,i,l){var a,T;return s()().wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return a=t.gateway,T=v()(t,h),L.abrupt("return",(0,m.request)("/api/v1/gateway".concat(a),r()({method:"PUT",headers:{"Content-Type":"application/json"},params:r()({},T),data:i},l||{})));case 2:case"end":return L.stop()}},n)})),M.apply(this,arguments)}function V(n,t){return D.apply(this,arguments)}function D(){return D=c()(s()().mark(function n(t,i){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,m.request)("/api/v1/location",r()({method:"GET",params:r()({},t)},i||{})));case 1:case"end":return a.stop()}},n)})),D.apply(this,arguments)}function g(n,t){return o.apply(this,arguments)}function o(){return o=c()(s()().mark(function n(t,i){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,m.request)("/api/v1/status/beacon",r()({method:"GET",params:r()({},t)},i||{})));case 1:case"end":return a.stop()}},n)})),o.apply(this,arguments)}function K(n,t){return b.apply(this,arguments)}function b(){return b=c()(s()().mark(function n(t,i){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,m.request)("/api/v1/status/gateway",r()({method:"GET",params:r()({},t)},i||{})));case 1:case"end":return a.stop()}},n)})),b.apply(this,arguments)}function $(n,t){return E.apply(this,arguments)}function E(){return E=c()(s()().mark(function n(t,i){return s()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",(0,m.request)("/api/v1/unbound/beacon",r()({method:"GET",params:r()({},t)},i||{})));case 1:case"end":return a.stop()}},n)})),E.apply(this,arguments)}}}]);
