"use strict";(self.webpackChunkheyanai_navigation=self.webpackChunkheyanai_navigation||[]).push([[528],{79962:function(ce,P,e){e.r(P),e.d(P,{StatisticOfNow:function(){return R},default:function(){return b}});var j=e(5574),u=e.n(j),x=e(76277),y=e(23809),S=e(84140),O=e(491),I=e(69851),$=e(88284),F=e(28508),Z=e(96604),z=e(90930),V=e(28199),N=e(34994),G=e(74763),o=e(48141),H=e(18629),J=e(25514),Q=e(71230),v=e(15746),X=e(72269),Y=e(4393),g=e(96486),me=e.n(g),l=e(67294),t=e(85893);function R(){var r=(0,o.useIntl)(),c=l.useState(Date.now()),d=u()(c,2),E=d[0],f=d[1];return(0,H.Z)(function(){return f(Date.now())},500),(0,t.jsx)(Z.Z,{layout:"vertical",title:r.formatMessage({id:"pages.position-manage.real-time-location.current-time",defaultMessage:"\u5F53\u524D\u65F6\u95F4"}),value:(0,I.ZN)(E),formatter:function(M){return(0,t.jsx)(J.Z.Text,{strong:!0,children:M})}})}function b(){var r,c,d,E=(0,o.useSearchParams)(),f=u()(E,1),m=f[0],M=m.get("gateway"),w=m.get("deviceId"),h=m.get("mapId"),C=l.useRef(null),k=l.useState(),T=u()(k,2),q=T[0],ee=T[1],te=l.useState(!0),p=u()(te,2),A=p[0],ne=p[1],ae=l.useState(),U=u()(ae,2),se=U[0],_e=U[1],L=(0,o.useRequest)(O.as,{manual:!0,formatResult:function(a){var s,i;return(s=(i=a.data)===null||i===void 0?void 0:i.items)!==null&&s!==void 0?s:[]}}),oe=L.run,ie=L.data,W=(0,o.useRequest)(O.FU,{manual:!0,formatResult:function(a){return a},onSuccess:function(a){if(a.code===I.OK){var s;if((s=a.data)!==null&&s!==void 0&&s.mapId){var i;oe({mapId:(i=a.data)===null||i===void 0?void 0:i.mapId,current:"1",size:"15"})}}}}),le=W.run,_=W.data,B=(0,o.useRequest)(S.uz,{manual:!0}),de=B.run,D=B.data,ue=(0,o.useModel)("messageSocket"),re=ue.beacons;function K(n){return de({mapId:n}),ee(n),le({mapId:n})}return l.useEffect(function(){var n,a,s=(n=(a=C.current)===null||a===void 0?void 0:a.getFieldValue(["mapId"]))!==null&&n!==void 0?n:h;s&&K(s)},[]),(0,t.jsxs)(z._z,{childrenContentStyle:{padding:20},children:[(0,t.jsx)(V.Z,{children:(0,t.jsx)(N.A,{submitter:!1,layout:"horizontal",formRef:C,onValuesChange:function(a){(0,G.k)(a.mapId)||K(a.mapId)},style:{alignItems:"end"},children:(0,t.jsxs)(Q.Z,{children:[(0,t.jsx)(v.Z,{span:"12",children:(0,t.jsx)(R,{})}),(0,t.jsxs)(v.Z,{span:"4",style:{display:"flex",alignItems:"end",justifyContent:"end"},children:[(0,t.jsx)(o.FormattedMessage,{id:"pages.position-manage.real-time-location.fence-switch",defaultMessage:"\u56F4\u680F\u5F00\u5173"}),(0,t.jsx)(X.Z,{style:{marginLeft:10},checked:A,onChange:function(a){return ne(a)},checkedChildren:(0,t.jsx)($.Z,{}),unCheckedChildren:(0,t.jsx)(F.Z,{})})]}),(0,t.jsx)(v.Z,{span:"8",style:{display:"flex",alignItems:"end",justifyContent:"end"},children:(0,t.jsx)(y.$,{initialValue:h,formItemProps:{style:{marginBottom:0}}})})]})})}),(0,t.jsx)(Y.Z,{style:{marginTop:12},children:(0,t.jsx)(x.W,{map:_==null||(r=_.data)===null||r===void 0?void 0:r.picture,rect:[_==null||(c=_.data)===null||c===void 0?void 0:c.length,_==null||(d=_.data)===null||d===void 0?void 0:d.width],stations:D==null?void 0:D.items,fences:ie,hiddenFence:!A,warningFenceId:se,clear:function(){return _e("")},selectedStation:M,selectedDeviceId:w,locations:(0,g.chain)(re).map(function(n){return n}).filter(function(n){return n.mapId===q}).value()})})]})}}}]);
