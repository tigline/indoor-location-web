"use strict";(self.webpackChunkheyanai_navigation=self.webpackChunkheyanai_navigation||[]).push([[232],{49796:function(le,D,t){t.r(D),t.d(D,{default:function(){return te}});var N=t(97857),O=t.n(N),W=t(13769),$=t.n(W),A=t(5574),j=t.n(A),h=t(36255),P=t(69851),Y=t(90930),L=t(9455),g=t(35312),z=t(54689),Q=t(71230),K=t(15746),B=t(4393),G=t(14e3),F=t(71577),y=t(96486),S=t(67294),Z=t(37476),I=t(5966),C=t(12029),a=t(85893);function T(n){var r=(0,g.useIntl)(),u=C.Z.useForm(),o=j()(u,1),f=o[0],p=(0,g.useRequest)(h.BZ,{manual:!0,onSuccess:function(s){if(s){var l;z.Z.success({message:r.formatMessage({id:"app.add.success",defaultMessage:"\u65B0\u5EFA\u6210\u529F"})}),(l=n.refresh)===null||l===void 0||l.call(n)}}}),c=p.run;return(0,a.jsxs)(Z.Y,{trigger:(0,a.jsx)(F.ZP,{size:"small",type:"link",children:r.formatMessage({id:"app.action.add",defaultMessage:"\u65B0\u5EFA"})}),title:r.formatMessage({id:"pages.personnel-manage.organization.department.add",defaultMessage:"\u6DFB\u52A0\u90E8\u95E8"}),form:f,width:520,layout:"horizontal",labelCol:{xs:6},wrapperCol:{xs:16},modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},onFinish:function(s){var l=s.name,v=s.parentId;return c({name:l,parentId:v})},children:[(0,a.jsx)(I.Z,{hidden:!0,name:"parentId",initialValue:n.parentId}),(0,a.jsx)(I.Z,{label:r.formatMessage({id:"pages.personnel-manage.organization.department.name",defaultMessage:"\u90E8\u95E8\u540D\u79F0"}),readonly:!0,initialValue:n.parentName,name:"parentName"}),(0,a.jsx)(I.Z,{name:"name",label:r.formatMessage({id:"pages.personnel-manage.organization.department.name",defaultMessage:"\u90E8\u95E8\u540D\u79F0"}),rules:[{required:!0,message:r.formatMessage({id:"pages.personnel-manage.organization.department.name.required.failure",defaultMessage:"\u90E8\u95E8\u540D\u79F0\u5FC5\u586B"})}]})]})}var H=t(1413),U=t(91),J=t(86682),X=["fieldProps","request","params","proFieldProps"],b=function(r,u){var o=r.fieldProps,f=r.request,p=r.params,c=r.proFieldProps,d=(0,U.Z)(r,X);return(0,a.jsx)(J.Z,(0,H.Z)({valueType:"treeSelect",fieldProps:o,ref:u,request:f,params:p,filedConfig:{customLightMode:!0},proFieldProps:c},d))},q=S.forwardRef(b),V=q;function w(n){var r=(0,g.useIntl)(),u=C.Z.useForm(),o=j()(u,1),f=o[0],p=(0,g.useRequest)(h.j4,{manual:!0,onSuccess:function(s){if(s){var l;z.Z.success({message:r.formatMessage({id:"app.edit.success",defaultMessage:"\u66F4\u65B0\u6210\u529F"})}),(l=n.refresh)===null||l===void 0||l.call(n)}}}),c=p.run;return(0,a.jsxs)(Z.Y,{trigger:(0,a.jsx)(F.ZP,{size:"small",type:"link",children:(0,a.jsx)("span",{children:r.formatMessage({id:"app.edit",defaultMessage:"\u66F4\u65B0"})})}),title:r.formatMessage({id:"pages.personnel-manage.organization.department.edit",defaultMessage:"\u6DFB\u52A0\u90E8\u95E8"}),form:f,width:520,layout:"horizontal",labelCol:{xs:6},wrapperCol:{xs:16},modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},onFinish:function(s){var l=s.name,v=s.parentId;return c({depId:n.depId},{name:l,parentId:v})},children:[(0,a.jsx)(V,{label:r.formatMessage({id:"pages.personnel-manage.organization.department.parent",defaultMessage:"\u90E8\u95E8\u540D\u79F0"}),allowClear:!0,name:"parentId",request:function(){var s;return Promise.resolve((s=n.treeData)!==null&&s!==void 0?s:[])},initialValue:n.parentId}),(0,a.jsx)(I.Z,{name:"name",initialValue:n.name,label:r.formatMessage({id:"pages.personnel-manage.organization.department.name",defaultMessage:"\u90E8\u95E8\u540D\u79F0"}),rules:[{required:!0,message:r.formatMessage({id:"pages.personnel-manage.organization.department.name.required.failure",defaultMessage:"\u90E8\u95E8\u540D\u79F0\u5FC5\u586B"})}]})]})}var k=t(88923),_=t(70162),ee=t(64317);function ae(n){var r,u,o=(0,g.useIntl)(),f=C.Z.useForm(),p=j()(f,1),c=p[0],d=(0,g.useRequest)(h.Ge,{manual:!0,onSuccess:function(v){if(v){var x;(x=n.refresh)===null||x===void 0||x.call(n),z.Z.success({message:o.formatMessage({id:"app.edit.success",defaultMessage:"\u66F4\u65B0\u6210\u529F"})})}}}),s=d.run;return S.useEffect(function(){},[]),(0,a.jsxs)(Z.Y,{width:520,layout:"horizontal",labelCol:{xs:6},wrapperCol:{xs:16},title:o.formatMessage({id:"pages.personnel-manage.organization.department.person.edit",defaultMessage:"\u66F4\u6362\u90E8\u95E8"}),modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},form:c,trigger:(0,a.jsx)(F.ZP,{size:"small",type:"link",children:o.formatMessage({id:"pages.personnel-manage.organization.department.person.edit",defaultMessage:"\u66F4\u6362\u90E8\u95E8"})}),onFinish:function(v){return s({personnelId:n.record.personnelId},v)},children:[(0,a.jsx)(k.h,{name:"avatar",label:o.formatMessage({id:"pages.personnel-manage.organization.department.person.icon",defaultMessage:"\u5934\u50CF"}),initialValue:[{uid:Date.now()+"",response:(r=n.record)===null||r===void 0?void 0:r.avatar,thumbUrl:(u=n.record)===null||u===void 0?void 0:u.avatar}]}),(0,a.jsx)(V,{request:function(){return Promise.resolve(n.treeData)},name:"depId",fieldProps:{treeDefaultExpandedKeys:[]},initialValue:n.record.depId,label:o.formatMessage({id:"pages.personnel-manage.organization.department.parent",defaultMessage:"\u6240\u5C5E\u90E8\u95E8"})}),(0,a.jsx)(I.Z,{readonly:!0,name:"name",initialValue:n.record.name,label:o.formatMessage({id:"pages.personnel-manage.organization.department.person.name",defaultMessage:"\u59D3\u540D"})}),(0,a.jsx)(ee.Z,{readonly:!0,label:o.formatMessage({id:"pages.personnel-manage.organization.department.person.gender",defaultMessage:"\u6027\u522B"}),name:"sex",initialValue:n.record.sex,valueEnum:{Male:o.formatMessage({id:"pages.personnel-manage.organization.department.person.gender.male",defaultMessage:"\u7537"}),Female:o.formatMessage({id:"pages.personnel-manage.organization.department.person.gender.female",defaultMessage:"\u5973"})}}),(0,a.jsx)(_.Q,{readonly:!0,initialValue:n.record.typeId,label:o.formatMessage({id:"pages.personnel-manage.organization.department.person.type",defaultMessage:"\u4EBA\u5458\u7C7B\u578B"}),name:"typeId"})]})}var ne=["current","pageSize","depId"];function te(){var n=(0,g.useIntl)(),r=S.useState(),u=j()(r,2),o=u[0],f=u[1];function p(m){return m==null?void 0:m.map(function(e){return{title:e.name,value:e.depId,key:e.depId+"",parentId:e.parentId,children:p(e.children)}})}var c=(0,g.useRequest)(h.sz,{manual:!0,formatResult:function(e){if(e.code===P.OK)return setTimeout(function(){var i;f((0,y.compact)([(i=(0,y.first)(e.data))===null||i===void 0?void 0:i.depId]))},300),p(e.data)}}),d=c.run,s=c.data;S.useEffect(function(){d()},[]);var l=(0,g.useRequest)(h.If,{manual:!0,fetchKey:function(e){return e.depId+""},onSuccess:function(e){e&&(z.Z.success({message:n.formatMessage({id:"app.remove.success",defaultMessage:"\u5220\u9664\u6210\u529F"})}),d())}}),v=l.run,x=l.fetches,re=(0,g.useRequest)(h.eQ,{manual:!0,formatResult:function(e){return(0,P.LF)(e)}}),E=re.run,se=[{title:n.formatMessage({id:"pages.personnel-manage.organization.department.person.name",defaultMessage:"\u59D3\u540D"}),dataIndex:"name"},{title:n.formatMessage({id:"pages.personnel-manage.organization.department.person.gender",defaultMessage:"\u6027\u522B"}),dataIndex:"sex",valueEnum:{Male:n.formatMessage({id:"pages.personnel-manage.organization.department.person.gender.male",defaultMessage:"\u7537"}),Female:n.formatMessage({id:"pages.personnel-manage.organization.department.person.gender.female",defaultMessage:"\u5973"})}},{title:n.formatMessage({id:"pages.personnel-manage.organization.department.parent",defaultMessage:"\u6240\u5C5E\u90E8\u95E8"}),dataIndex:"depName"},{title:n.formatMessage({id:"pages.personnel-manage.organization.department.person.type",defaultMessage:"\u4EBA\u5458\u7C7B\u578B"}),dataIndex:"typeName"},{title:n.formatMessage({id:"app.action",defaultMessage:"\u64CD\u4F5C"}),render:function(e,i,R,M){return(0,a.jsx)(ae,{treeData:s!=null?s:[],record:i,refresh:M==null?void 0:M.reload})}}];return(0,a.jsx)(Y._z,{childrenContentStyle:{padding:20},children:(0,a.jsxs)(Q.Z,{gutter:[16,16],children:[(0,a.jsx)(K.Z,{flex:"320px",children:(0,a.jsx)(B.Z,{bodyStyle:{minHeight:600,overflow:"auto",maxWidth:"100%"},extra:(0,a.jsx)(T,{refresh:d}),children:(0,a.jsx)(G.Z,{treeData:s,blockNode:!0,onSelect:function(e){(0,y.isEmpty)(e)||f(e);var i=(0,y.first)(e);i&&E({depId:i})},selectedKeys:o,titleRender:function(e){var i;return(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,a.jsx)("span",{style:{whiteSpace:"nowrap"},children:e.title}),(0,a.jsxs)("span",{className:"department-action",children:[(0,a.jsx)(T,{parentId:e.key,parentName:e.title,refresh:d}),(0,a.jsx)(w,{treeData:s,name:e.title,depId:e.key,parentId:e.parentId,refresh:d}),(0,a.jsx)(F.ZP,{size:"small",type:"link",loading:x==null||(i=x[e.key])===null||i===void 0?void 0:i.loading,onClick:function(M){return M.preventDefault(),v({depId:e.key})},children:n.formatMessage({id:"app.remove",defaultMessage:"\u5220\u9664"})})]})]})}})})}),(0,a.jsx)(K.Z,{flex:"auto",children:(0,a.jsx)(L.Z,{options:{setting:!1},request:function(e){var i=e.current,R=e.pageSize,M=e.depId,oe=$()(e,ne);return M?E(O()({current:i+"",size:R+"",depId:M},oe)):Promise.resolve({code:P.OK})},rowKey:function(e){return e.personnelId+""},columns:se,search:!1,params:{depId:(0,y.first)(o)}})})]})})}}}]);
